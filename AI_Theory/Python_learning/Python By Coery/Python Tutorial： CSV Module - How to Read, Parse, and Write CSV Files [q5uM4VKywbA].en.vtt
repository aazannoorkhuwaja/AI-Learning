WEBVTT
Kind: captions
Language: en

00:00:00.500 --> 00:00:02.040
Hey there. How's it going everybody in this video?

00:00:02.040 --> 00:00:04.650
We're going to be looking at how to read parse and write

00:00:04.810 --> 00:00:10.380
CSV files now if you don't know what CSV files are it stands for comma separated values basically

00:00:10.630 --> 00:00:13.769
CSV files allow us to put into a plain text file

00:00:14.170 --> 00:00:19.770
Some data and use some type of delimiter usually a comma to separate the different fields now

00:00:19.770 --> 00:00:25.979
I have a sample CSV file here that we can work with and if we look at this then we can see how these are

00:00:25.980 --> 00:00:30.599
Usually structured so this can kind of look like a mess, but it's not really meant to be read directly

00:00:30.699 --> 00:00:32.699
This is just how the data is stored

00:00:32.700 --> 00:00:37.290
And then we can use our programs to parse out the information that we want, but we can see that the top

00:00:37.840 --> 00:00:43.200
Line here has our fields now our fields in this file are first name

00:00:43.750 --> 00:00:49.439
Last name and email so that tells us the information that we should expect to see on every line

00:00:49.450 --> 00:00:52.409
so if I go to the next line here

00:00:52.410 --> 00:00:56.820
then we can see that John is the first name and then a comma

00:00:56.980 --> 00:01:00.539
though is the last name and then a comma and then

00:01:00.670 --> 00:01:08.640
This long email here is the email so that's why these are called comma separated values and what separates two values is called a delimiter

00:01:08.890 --> 00:01:11.099
So the comma is a common delimiter

00:01:11.100 --> 00:01:18.360
But you can use just about anything so sometimes you'll see files with tab delimited values or dashes or things like that

00:01:18.360 --> 00:01:24.959
But they're all called CSV files. So now let's see what it's like to read parts and write to CSV files

00:01:24.960 --> 00:01:29.489
So I have a file here called Parse CSV pie and within this file

00:01:29.490 --> 00:01:33.900
We're just going to import CSV now you may have looked at that Data and wondered

00:01:33.900 --> 00:01:39.779
Why we're just not using it the strings split method on each line of the file to parse out the data and you could do

00:01:39.780 --> 00:01:44.369
That but the CSV module just makes parsing these files so much easier

00:01:44.369 --> 00:01:50.699
so for example if someone puts a comma or something in their name for some reason then we wouldn't want to split on that and

00:01:50.950 --> 00:01:57.030
also the CSV module will handle new lines and all those things so it just makes it a lot easier to parse out all the

00:01:57.040 --> 00:02:02.819
Information that we want without writing something complicated from scratch okay, so to read the CSV file

00:02:02.860 --> 00:02:05.669
We're just going to open this file. Just like any other file

00:02:05.670 --> 00:02:08.069
So we'll use a context manager here

00:02:08.069 --> 00:02:13.079
And we'll say with open and the name of that file that I was just looking at is now

00:02:13.690 --> 00:02:19.919
CSV, and it's in the same directory as the file that I'm currently writing and we want to read this file

00:02:19.920 --> 00:02:26.910
So we'll put an r there as the second value and now what we want to call this so we'll say CSV file

00:02:26.910 --> 00:02:28.750
So to read this file

00:02:28.750 --> 00:02:34.500
We can say CSV reader and that can be any variable name that you like, but that's what I like

00:02:34.500 --> 00:02:40.110
And then we can say CSV and then use this reader method and then pass that

00:02:40.390 --> 00:02:47.610
CSV file in to that reader method now in the background that reader method is using something called a dialect that has some preset parameters

00:02:47.709 --> 00:02:52.259
for what it expects the format of our CSV file to be so by default it's

00:02:52.360 --> 00:02:53.470
expecting values to be

00:02:53.470 --> 00:02:56.669
Separated by a comma and a few other things that we'll look at in

00:02:56.670 --> 00:02:59.459
Just a bit, but since our CSV file is pretty simple

00:02:59.650 --> 00:03:02.429
We don't need to pass any additional arguments right now

00:03:02.530 --> 00:03:07.829
So the CSV reader variable that we just created is going to be something that we need to iterate over

00:03:07.989 --> 00:03:12.479
So for example if we just print this out as is so print

00:03:12.640 --> 00:03:18.329
CSV reader and run that then we can see that right now. It's just an object in memory, so instead

00:03:18.329 --> 00:03:24.449
We need to loop over all these lines in the reader and see what we get so we can say for line in

00:03:25.239 --> 00:03:28.559
CSV reader and then print out each line

00:03:28.560 --> 00:03:33.239
And we'll run that ok so that looks better so each line that

00:03:33.239 --> 00:03:39.929
We're printing out is a list of all the values so the first value in the list is the name as the first name

00:03:40.000 --> 00:03:45.660
The second value in the list is the last name and the email is the third value if I scroll all the way up to

00:03:45.660 --> 00:03:49.439
the top you can see that our first line is the

00:03:49.630 --> 00:03:54.569
field names so it tells us that the you know first value this first name last name is the

00:03:54.639 --> 00:03:56.699
Second value and Third value is email

00:03:56.709 --> 00:03:58.569
so for example if we're going by the

00:03:58.569 --> 00:04:05.098
Index like this would be index 0 and then 1 and then the email would be index 2 if we only wanted to print out

00:04:05.099 --> 00:04:10.949
All of the indexes then on this line here, we could say let's print out index 2 of each line

00:04:10.950 --> 00:04:17.369
And if we run that and we can see that now we get all of the emails printed out now if you don't want this

00:04:17.370 --> 00:04:22.260
First line of the field names and only want the values then we can just skip that first line

00:04:22.270 --> 00:04:24.780
so if anyone has seen my video on generators

00:04:24.780 --> 00:04:30.000
and we can actually step over value an iterable by calling next and running next we'll

00:04:30.190 --> 00:04:33.240
Return the next value if we want to capture that in a variable

00:04:33.240 --> 00:04:39.629
But if we just want to step over the value then we can come up here before our list. We can just say next

00:04:40.510 --> 00:04:43.409
CSV reader and that will loop over that first line

00:04:43.410 --> 00:04:48.179
And then when we iterate through this it should start at the second value

00:04:48.190 --> 00:04:53.130
Which is the first person in the list so now if we rerun this and scroll up to the top?

00:04:53.380 --> 00:04:56.999
Now we can see that that John doe is now the first value, okay?

00:04:57.000 --> 00:04:59.730
So now let's see how we can write to a CSV file now

00:04:59.730 --> 00:05:05.700
We can do this with any list values, but since we're already have a list of values here from our original CSV file

00:05:05.740 --> 00:05:12.330
Let's go ahead and just use those so let's say that we wanted to save these same values into a new CSV file

00:05:12.370 --> 00:05:15.989
But use dashes instead of commas for the delimiter now

00:05:15.990 --> 00:05:21.390
Dash is probably isn't a great delimiter, but I just want to show you something that happens when we do this now first

00:05:21.390 --> 00:05:25.229
We're going to want to write the field name headers into the new file

00:05:25.270 --> 00:05:29.879
So let's take out this next statement where we're skipping over those so

00:05:30.190 --> 00:05:33.570
Now I'll come down here and now actually above our loop

00:05:33.570 --> 00:05:37.110
we're going to want to open a new file for writing and

00:05:37.600 --> 00:05:43.049
So we'll say with open and we'll call this file new underscore names

00:05:43.510 --> 00:05:44.080
CSV

00:05:44.080 --> 00:05:46.050
We want to open this for writing

00:05:46.050 --> 00:05:50.910
so the second argument is aw, then we'll say as and we'll just call this a

00:05:51.130 --> 00:05:53.939
variable new file and to write to this file

00:05:53.940 --> 00:05:59.999
We're going to use a CSV writer so we can say CSV writer and that can be any variable name

00:06:00.040 --> 00:06:05.040
But that makes sense to me and we'll do CSV and then use this writer

00:06:05.260 --> 00:06:11.609
Method and we're going to pass in new file to that writer method now if we left it like this then it would just write

00:06:11.610 --> 00:06:12.550
the same comma

00:06:12.550 --> 00:06:17.190
Separated file that we currently have now but if we want to use dashes as our delimiter

00:06:17.200 --> 00:06:20.249
Then we need to pass that in as an argument

00:06:20.250 --> 00:06:26.489
So it's going to be the second argument to that writer method and we can say delimiter equals

00:06:26.490 --> 00:06:28.980
And we'll just go use a dash now

00:06:28.980 --> 00:06:35.939
We want to write each line of our original CSV file into this new file, so let's indent our for loop over here

00:06:35.940 --> 00:06:40.410
So that now we're within the context manager of this new file and for each

00:06:40.920 --> 00:06:44.039
Line in this CSV reader. Which is our original file

00:06:44.080 --> 00:06:48.150
We want to write that to a new file so we can do that by saying

00:06:49.360 --> 00:06:53.279
CSV writer dot write Row and

00:06:54.070 --> 00:06:58.290
The row that we want to write is that line from the original reader?

00:06:58.540 --> 00:07:06.150
So real quick before I run this we are opening the original file to be read and then we're creating this CSV

00:07:06.340 --> 00:07:07.150
reader

00:07:07.150 --> 00:07:08.860
variable and we are

00:07:08.860 --> 00:07:13.530
using the CSV reader method to read that original CSV file

00:07:13.530 --> 00:07:18.869
and then we're opening a new file for writing called new Names CSV and

00:07:19.330 --> 00:07:21.599
Then we're creating a CSV writer

00:07:22.270 --> 00:07:26.789
variable and we're using this writer method of the CSV module to

00:07:27.310 --> 00:07:34.530
Open up a writer using that new file with a delimiter of a dash and then for each line in this original

00:07:35.380 --> 00:07:41.460
CSV data we are writing out to the new file each line of the original file

00:07:41.560 --> 00:07:46.920
So now if we run this then we don't have any output here at the bottom

00:07:46.920 --> 00:07:53.400
But it should have created this new file called new named CSV and I'll go ahead and open that up now

00:07:53.400 --> 00:07:58.859
We can see in this new file that. It's using dashes instead of commas for the delimiter now

00:07:58.860 --> 00:08:03.509
This makes it pretty hard to read, but I wanted to show you what it did with two of our values here

00:08:03.510 --> 00:08:08.999
So in our first value the email actually contained a dash so we can see here that our

00:08:09.190 --> 00:08:13.170
CSV writer knew to put quotes around the email

00:08:13.930 --> 00:08:16.200
Since it can't contain that delimiter

00:08:16.200 --> 00:08:21.150
And that's so when the CSV is read back in that it would know that the email is

00:08:21.340 --> 00:08:26.909
One whole value and that it shouldn't be split on the dash within the email itself and likewise here

00:08:26.910 --> 00:08:32.999
We can see that our second person here has a hyphenated last name of Smith Robinson

00:08:33.000 --> 00:08:38.910
so again the CSV writer knew to put quotes around the last name so that it can tell the difference between the

00:08:38.979 --> 00:08:42.209
delimiters and the values that just happen to contain dashes

00:08:42.280 --> 00:08:47.729
So now that we've seen how that works let's actually change this delimiter for the new file to something

00:08:47.730 --> 00:08:49.830
that's a bit more common, so aside from

00:08:50.470 --> 00:08:53.609
Commas tabs are very common Des limiters

00:08:53.610 --> 00:08:58.840
So let's use tab instead and in python the tab can be represented with this backslash t

00:08:58.840 --> 00:09:03.280
and if we rerun that and then open up the new names file again

00:09:03.280 --> 00:09:08.979
Then we can see that now all the values are separated by tabs instead. That's a lot more easier

00:09:09.140 --> 00:09:11.499
That's a lot more easy to read now

00:09:11.500 --> 00:09:17.140
Just like we passed the delimiter into our writer if we wanted to read in that tab delimited file

00:09:17.180 --> 00:09:20.739
then you could pass the delimiter argument into the reader as well, and

00:09:20.900 --> 00:09:27.189
Real quick let me show you what that would look like if we tried to read a CSV file with the wrong delimiter

00:09:27.530 --> 00:09:33.069
So let me copy part of this here where we're reading in this file

00:09:33.070 --> 00:09:39.820
And now I'm just going to comment out everything else for now now instead of reading the original file names

00:09:40.250 --> 00:09:40.750
CSV

00:09:40.750 --> 00:09:47.950
We're instead going to read the new tab delimited file that we just created which is new underscore names CSV now

00:09:47.950 --> 00:09:49.950
Let's pretend that we forgot to

00:09:50.150 --> 00:09:57.280
Specify the Tab delimiter and just try to read this as is so let's print out the lines that we get from this reader

00:09:57.280 --> 00:09:59.280
So we'll say four line in

00:09:59.930 --> 00:10:03.880
CSV reader and we will print out each line

00:10:05.480 --> 00:10:08.890
So we can see that each line only has one value

00:10:08.890 --> 00:10:14.259
And it didn't split on the values on the tab because it was expecting commas

00:10:14.260 --> 00:10:19.840
So instead you have to explicitly pass in that we want the delimiter to be a tab

00:10:19.840 --> 00:10:25.419
so I'll pass that into the reader method here and say delimiter equals a

00:10:26.900 --> 00:10:33.129
Backslash t for tab and then rerun that and now you can see that we get the correct parsing okay?

00:10:33.130 --> 00:10:36.070
so now I'm going to delete these lines here and

00:10:36.620 --> 00:10:38.799
Uncomment out what we had before

00:10:39.590 --> 00:10:46.749
Okay, so the way that we've been working with CSV files using the reader and writer is probably the more common way to work with

00:10:46.750 --> 00:10:50.410
CSV data since they're the first things that come up in the python documentation

00:10:50.960 --> 00:10:54.429
But my preferred method is working with CSV data

00:10:55.130 --> 00:10:58.030
using the dictionary reader and the dictionary writer

00:10:58.040 --> 00:11:03.639
So let's take a look at those and I'll explain why I prefer them over the regular reader and writer okay, so first

00:11:03.640 --> 00:11:05.830
Let's take a look at the dictionary reader

00:11:05.870 --> 00:11:10.989
So to use this we're just going to replace the regular reader method here with a dict

00:11:11.270 --> 00:11:17.259
Reader and now let's print out the lines that we give with this so I'll say four line in

00:11:18.230 --> 00:11:22.240
CSV reader and we'll just print out each line

00:11:23.540 --> 00:11:31.510
Okay, so at first glance this may look a little more complicated each of the values is now an ordered dictionary and if we scroll

00:11:31.510 --> 00:11:36.189
Up here to the top then we can see that that first line no longer contains the field names

00:11:36.339 --> 00:11:39.099
It starts off immediately with the first person

00:11:39.170 --> 00:11:45.969
So the reason is that the field names are now the keys of each of these values here now the reason

00:11:45.970 --> 00:11:52.000
I like this is because it makes it a lot easier to parse out the information that we want so for example remember when we

00:11:52.000 --> 00:11:54.909
Use the regular reader if we wanted to print out the email

00:11:55.130 --> 00:12:00.489
Address then we printed out the second index of our line well for anyone reading your code

00:12:00.490 --> 00:12:07.240
It isn't obvious what that second index is so they'd have to go into the CSV file to find that information out

00:12:07.370 --> 00:12:09.370
But now that we have those

00:12:09.650 --> 00:12:14.079
Fields as our dictionary keys then we can get the email here by saying

00:12:14.080 --> 00:12:15.740
I just want the

00:12:15.740 --> 00:12:17.170
Email of that line

00:12:17.170 --> 00:12:22.960
So we just access that key so now if we rerun that we can see that now we have all of the email information

00:12:23.360 --> 00:12:26.469
Okay, and now let's look at how to use the dictionary writer

00:12:26.540 --> 00:12:33.640
So I'm going to remove this loop and then uncomment out the rest of this information here

00:12:34.310 --> 00:12:39.339
Now with the dictionary reader. We really didn't need to change anything, but with the dictionary writer

00:12:39.350 --> 00:12:46.360
We actually have to provide the field names of our file, so one line above our writer here

00:12:46.360 --> 00:12:50.260
I'm just going to create a list of the field names

00:12:57.420 --> 00:13:03.349
And now instead of using this writer method. We're instead going to use dict writer

00:13:04.049 --> 00:13:09.858
Now one thing that we need to change there here is that after the file that we're going to be writing to we need to?

00:13:09.859 --> 00:13:15.889
Pass in those field names, so I'll say field names is equal to field names

00:13:16.769 --> 00:13:23.659
Okay, and now we're ready to write the data so with the dictionary writer you have the option of whether or not you want to

00:13:23.660 --> 00:13:27.259
Write out those headers. Which are the field names in the first row

00:13:27.269 --> 00:13:32.628
so if we want those headers, which most of the time I do then we can say

00:13:33.239 --> 00:13:35.839
CSV writer Dot right

00:13:36.480 --> 00:13:38.069
header

00:13:38.069 --> 00:13:42.858
So that's going to write out those field names as the first line and once the header is written out

00:13:42.869 --> 00:13:45.949
We can loop through the lines of the original file

00:13:45.949 --> 00:13:53.508
Just like we did before and say CSV writer dot right row and then pass in that line so all of that stays the same

00:13:53.730 --> 00:14:01.189
so if we run this and then look over here at our new names CSV file then we can see that that still worked and

00:14:01.619 --> 00:14:07.339
Like I said before the reason I like working with the dictionary reader and writer is because it's more obvious what you're doing

00:14:07.339 --> 00:14:10.188
So let's say for example that in our new CSV file

00:14:10.230 --> 00:14:16.909
We actually only wanted the first and last names and wanted to leave off the email well with the regular reader and writer

00:14:16.949 --> 00:14:23.389
We'd be modifying the indexes of those list and like I mentioned before it's not obvious by looking at an index

00:14:23.429 --> 00:14:30.319
What value it's supposed to hold but with our dictionary writer? We can just remove the email from the field names up here and

00:14:31.769 --> 00:14:35.118
Before we write each line within our loop here

00:14:35.309 --> 00:14:41.538
We can just remove the email key and value and one way to do that is to just delete it so we can say

00:14:41.789 --> 00:14:43.350
delete the

00:14:43.350 --> 00:14:44.399
email of

00:14:44.399 --> 00:14:50.688
That line so now when it writes that row it's only going to be writing the first name and the last name and the email

00:14:50.879 --> 00:14:52.339
no longer exists

00:14:52.339 --> 00:14:58.128
So now if we save that and run it and then I open up the new names dot CSV file here then you can see

00:14:58.129 --> 00:15:04.219
That now we just have a tab delimited file of first names and last names and that email is no longer there

00:15:04.319 --> 00:15:10.789
Now there are several ways that we could have written this row. We could have deleted the email key from Line

00:15:10.790 --> 00:15:14.209
Just like we did here or we could have created a new dictionary?

00:15:14.579 --> 00:15:19.849
With only the first name and last name keys and passed that into the right Road method

00:15:19.850 --> 00:15:23.929
So whichever way works for you in this case. I think it was easier

00:15:23.929 --> 00:15:27.889
Just to remove the email key okay, so I think that is going to do it for this video

00:15:27.889 --> 00:15:33.048
I hope that now you have a pretty good idea for how you can read parse and write CSV files

00:15:33.059 --> 00:15:36.319
But if anyone does have any questions about what we covered in this video

00:15:36.329 --> 00:15:41.688
then feel free to ask in the comment section below and I'll do my best to answer those and if you enjoy these tutorials and

00:15:41.689 --> 00:15:46.488
Would like to support them and there are several ways you can do that the easiest ways to simply like the video and give it

00:15:46.489 --> 00:15:47.480
a thumbs up and also

00:15:47.480 --> 00:15:52.219
It's a huge help to share these videos with anyone who you think would find them useful and if you have the means you can

00:15:52.220 --> 00:15:53.269
contribute through Patreon

00:15:53.269 --> 00:15:58.849
And there's a link to that page in the description section below be sure to subscribe for future videos and thank you all for watching

00:16:10.000 --> 00:16:12.000
you

